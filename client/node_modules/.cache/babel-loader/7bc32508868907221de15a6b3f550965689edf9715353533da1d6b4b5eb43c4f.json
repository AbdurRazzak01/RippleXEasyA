{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.sortAndLimitOffers = exports.separateBuySellOrders = exports.combineOrders = exports.extractOffers = exports.reverseRequest = exports.requestAllOffers = exports.createBookOffersRequest = exports.validateOrderbookOptions = void 0;\nconst bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\nconst errors_1 = require(\"../errors\");\nconst Offer_1 = require(\"../models/ledger/Offer\");\nconst DEFAULT_LIMIT = 20;\nfunction sortOffers(offers) {\n  return offers.sort((offerA, offerB) => {\n    var _a, _b;\n    const qualityA = (_a = offerA.quality) !== null && _a !== void 0 ? _a : 0;\n    const qualityB = (_b = offerB.quality) !== null && _b !== void 0 ? _b : 0;\n    return new bignumber_js_1.default(qualityA).comparedTo(qualityB);\n  });\n}\nconst getOrderbookOptionsSet = new Set(['limit', 'ledger_index', 'ledger_hash', 'taker']);\nfunction validateOrderbookOptions(options) {\n  for (const key of Object.keys(options)) {\n    if (!getOrderbookOptionsSet.has(key)) {\n      throw new errors_1.ValidationError(`Unexpected option: ${key}`, options);\n    }\n  }\n  if (options.limit && typeof options.limit !== 'number') {\n    throw new errors_1.ValidationError('limit must be a number', options.limit);\n  }\n  if (options.ledger_index && !(typeof options.ledger_index === 'number' || typeof options.ledger_index === 'string' && ['validated', 'closed', 'current'].includes(options.ledger_index))) {\n    throw new errors_1.ValidationError('ledger_index must be a number or a string of \"validated\", \"closed\", or \"current\"', options.ledger_index);\n  }\n  if (options.ledger_hash !== undefined && options.ledger_hash !== null && typeof options.ledger_hash !== 'string') {\n    throw new errors_1.ValidationError('ledger_hash must be a string', options.ledger_hash);\n  }\n  if (options.taker !== undefined && typeof options.taker !== 'string') {\n    throw new errors_1.ValidationError('taker must be a string', options.taker);\n  }\n}\nexports.validateOrderbookOptions = validateOrderbookOptions;\nfunction createBookOffersRequest(currency1, currency2, options) {\n  var _a, _b;\n  const request = {\n    command: 'book_offers',\n    taker_pays: currency1,\n    taker_gets: currency2,\n    ledger_index: (_a = options.ledger_index) !== null && _a !== void 0 ? _a : 'validated',\n    ledger_hash: options.ledger_hash === null ? undefined : options.ledger_hash,\n    limit: (_b = options.limit) !== null && _b !== void 0 ? _b : DEFAULT_LIMIT,\n    taker: options.taker ? options.taker : undefined\n  };\n  return request;\n}\nexports.createBookOffersRequest = createBookOffersRequest;\nfunction requestAllOffers(client, request) {\n  return __awaiter(this, void 0, void 0, function* () {\n    const results = yield client.requestAll(request);\n    return results.map(result => result.result.offers);\n  });\n}\nexports.requestAllOffers = requestAllOffers;\nfunction reverseRequest(request) {\n  return Object.assign(Object.assign({}, request), {\n    taker_pays: request.taker_gets,\n    taker_gets: request.taker_pays\n  });\n}\nexports.reverseRequest = reverseRequest;\nfunction extractOffers(offerResults) {\n  return offerResults.flatMap(offerResult => offerResult);\n}\nexports.extractOffers = extractOffers;\nfunction combineOrders(directOffers, reverseOffers) {\n  return [...directOffers, ...reverseOffers];\n}\nexports.combineOrders = combineOrders;\nfunction separateBuySellOrders(orders) {\n  const buy = [];\n  const sell = [];\n  orders.forEach(order => {\n    if ((order.Flags & Offer_1.OfferFlags.lsfSell) === 0) {\n      buy.push(order);\n    } else {\n      sell.push(order);\n    }\n  });\n  return {\n    buy,\n    sell\n  };\n}\nexports.separateBuySellOrders = separateBuySellOrders;\nfunction sortAndLimitOffers(offers, limit) {\n  const sortedOffers = sortOffers(offers);\n  return sortedOffers.slice(0, limit);\n}\nexports.sortAndLimitOffers = sortAndLimitOffers;","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__importDefault","mod","__esModule","Object","defineProperty","exports","sortAndLimitOffers","separateBuySellOrders","combineOrders","extractOffers","reverseRequest","requestAllOffers","createBookOffersRequest","validateOrderbookOptions","bignumber_js_1","require","errors_1","Offer_1","DEFAULT_LIMIT","sortOffers","offers","sort","offerA","offerB","_a","_b","qualityA","quality","qualityB","default","comparedTo","getOrderbookOptionsSet","Set","options","key","keys","has","ValidationError","limit","ledger_index","includes","ledger_hash","undefined","taker","currency1","currency2","request","command","taker_pays","taker_gets","client","results","requestAll","map","assign","offerResults","flatMap","offerResult","directOffers","reverseOffers","orders","buy","sell","forEach","order","Flags","OfferFlags","lsfSell","push","sortedOffers","slice"],"sources":["/Users/mdabdurrazzak/XRPL_React_App/node_modules/xrpl/dist/npm/sugar/getOrderbook.js"],"sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sortAndLimitOffers = exports.separateBuySellOrders = exports.combineOrders = exports.extractOffers = exports.reverseRequest = exports.requestAllOffers = exports.createBookOffersRequest = exports.validateOrderbookOptions = void 0;\nconst bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\nconst errors_1 = require(\"../errors\");\nconst Offer_1 = require(\"../models/ledger/Offer\");\nconst DEFAULT_LIMIT = 20;\nfunction sortOffers(offers) {\n    return offers.sort((offerA, offerB) => {\n        var _a, _b;\n        const qualityA = (_a = offerA.quality) !== null && _a !== void 0 ? _a : 0;\n        const qualityB = (_b = offerB.quality) !== null && _b !== void 0 ? _b : 0;\n        return new bignumber_js_1.default(qualityA).comparedTo(qualityB);\n    });\n}\nconst getOrderbookOptionsSet = new Set([\n    'limit',\n    'ledger_index',\n    'ledger_hash',\n    'taker',\n]);\nfunction validateOrderbookOptions(options) {\n    for (const key of Object.keys(options)) {\n        if (!getOrderbookOptionsSet.has(key)) {\n            throw new errors_1.ValidationError(`Unexpected option: ${key}`, options);\n        }\n    }\n    if (options.limit && typeof options.limit !== 'number') {\n        throw new errors_1.ValidationError('limit must be a number', options.limit);\n    }\n    if (options.ledger_index &&\n        !(typeof options.ledger_index === 'number' ||\n            (typeof options.ledger_index === 'string' &&\n                ['validated', 'closed', 'current'].includes(options.ledger_index)))) {\n        throw new errors_1.ValidationError('ledger_index must be a number or a string of \"validated\", \"closed\", or \"current\"', options.ledger_index);\n    }\n    if (options.ledger_hash !== undefined &&\n        options.ledger_hash !== null &&\n        typeof options.ledger_hash !== 'string') {\n        throw new errors_1.ValidationError('ledger_hash must be a string', options.ledger_hash);\n    }\n    if (options.taker !== undefined && typeof options.taker !== 'string') {\n        throw new errors_1.ValidationError('taker must be a string', options.taker);\n    }\n}\nexports.validateOrderbookOptions = validateOrderbookOptions;\nfunction createBookOffersRequest(currency1, currency2, options) {\n    var _a, _b;\n    const request = {\n        command: 'book_offers',\n        taker_pays: currency1,\n        taker_gets: currency2,\n        ledger_index: (_a = options.ledger_index) !== null && _a !== void 0 ? _a : 'validated',\n        ledger_hash: options.ledger_hash === null ? undefined : options.ledger_hash,\n        limit: (_b = options.limit) !== null && _b !== void 0 ? _b : DEFAULT_LIMIT,\n        taker: options.taker ? options.taker : undefined,\n    };\n    return request;\n}\nexports.createBookOffersRequest = createBookOffersRequest;\nfunction requestAllOffers(client, request) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const results = yield client.requestAll(request);\n        return results.map((result) => result.result.offers);\n    });\n}\nexports.requestAllOffers = requestAllOffers;\nfunction reverseRequest(request) {\n    return Object.assign(Object.assign({}, request), { taker_pays: request.taker_gets, taker_gets: request.taker_pays });\n}\nexports.reverseRequest = reverseRequest;\nfunction extractOffers(offerResults) {\n    return offerResults.flatMap((offerResult) => offerResult);\n}\nexports.extractOffers = extractOffers;\nfunction combineOrders(directOffers, reverseOffers) {\n    return [...directOffers, ...reverseOffers];\n}\nexports.combineOrders = combineOrders;\nfunction separateBuySellOrders(orders) {\n    const buy = [];\n    const sell = [];\n    orders.forEach((order) => {\n        if ((order.Flags & Offer_1.OfferFlags.lsfSell) === 0) {\n            buy.push(order);\n        }\n        else {\n            sell.push(order);\n        }\n    });\n    return { buy, sell };\n}\nexports.separateBuySellOrders = separateBuySellOrders;\nfunction sortAndLimitOffers(offers, limit) {\n    const sortedOffers = sortOffers(offers);\n    return sortedOffers.slice(0, limit);\n}\nexports.sortAndLimitOffers = sortAndLimitOffers;\n//# sourceMappingURL=getOrderbook.js.map"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}